
# Release Notes worksheet dynamo

The main goal of this process is to rephrase all the commit messages below to make them **clear and easy to read** by the end user. You should follow the following instructions to do so:

* **Please clean up and format commit titles to be readable by the general PyTorch user.** Make sure you're [following the guidance here](https://docs.google.com/document/d/14OmgGBr1w6gl1VO47GGGdwrIaUNr92DFhQbY_NEk8mQ/edit)! Your resulting notes must be consistent and easy to read.
* Please sort commits into the following categories (you should not rename the categories!), I tried to pre-sort these to ease your work, feel free to move commits around if the current categorization is not good.
* Anything that is not public facing needs to be removed.
* If anything is miscategorized/belongs to another domain, move it to `miscategorized.md`.
* Please scan through `miscategorized.md` and handle any commits that belong within your domain according to these instructions.
* We place a lot of emphasis on the “BC-breaking” and “deprecation” sections. Those should be where the most effort goes in. The “improvements” and “bug fixes” for Python API should be nice as well.
* Once you are finished, move this very file from `todo/` to `done/` and submit a pull request.

The categories below are as follows:

* BC breaking: All commits that are BC-breaking. These are the most important commits. If any pre-sorted commit is actually BC-breaking, do move it to this section. Each commit should contain a paragraph explaining the rational behind the change as well as an example for how to update user code [BC-Guidelines](https://docs.google.com/document/d/14OmgGBr1w6gl1VO47GGGdwrIaUNr92DFhQbY_NEk8mQ/edit#heading=h.a9htwgvvec1m).
* Deprecations: All commits introducing deprecation. Each commit should include a small example explaining what should be done to update user code.
* new_features: All commits introducing a new feature (new functions, new submodule, new supported platform etc)
* improvements: All commits providing improvements to existing feature should be here (new backend for a function, new argument, better numerical stability)
* bug fixes: All commits that fix bugs and behaviors that do not match the documentation
* performance: All commits that are added mainly for performance (we separate this from improvements above to make it easier for users to look for it)
* documentation: All commits that add/update documentation
* Developers: All commits that are not end-user facing but still impact people that compile from source, develop into pytorch, extend pytorch, etc
* not user facing: All commits that are not public end-user facing and hence should be dropped from the release notes

## dynamo
### bc breaking
### deprecation
### new features
- Implement guard collectives ([#155558](https://github.com/pytorch/pytorch/pull/155558))
- Implement guard collectives ([#155558](https://github.com/pytorch/pytorch/pull/155558))
- Implement guard collectives (optimized version) ([#156562](https://github.com/pytorch/pytorch/pull/156562))
### improvements
- [Dynamo] Introduce hook receiving list of traced code objects ([#153622](https://github.com/pytorch/pytorch/pull/153622))
- Replace frame_traced_fn hook with get_traced_code() util ([#155249](https://github.com/pytorch/pytorch/pull/155249))
### bug fixes
- [dynamo] fix bug where non-recursive disable modifies the original function ([#148896](https://github.com/pytorch/pytorch/pull/148896))
### performance
### docs
### devs
### Untopiced
- [hop] support base_hop._gen_schema ([#149688](https://github.com/pytorch/pytorch/pull/149688))
- Fix printing INT64_MIN ([#149148](https://github.com/pytorch/pytorch/pull/149148))
- [compile] Switch off inference mode during compilation ([#149321](https://github.com/pytorch/pytorch/pull/149321))
- [dynamo] support Python 3.13t ([#149549](https://github.com/pytorch/pytorch/pull/149549))
- [Dynamo] Refactor DisableTorchFunction ctx manager ([#149489](https://github.com/pytorch/pytorch/pull/149489))
- [Dynamo] add support for torch._C._is_torch_function_all_disabled ([#149490](https://github.com/pytorch/pytorch/pull/149490))
- [Dynamo] Support the torch._C.DisableTorchFunction ctx manager ([#149491](https://github.com/pytorch/pytorch/pull/149491))
- [Dynamo] Cleanup state management for ctx managers ([#149689](https://github.com/pytorch/pytorch/pull/149689))
- [Hierarchical Compilation] Handle origin nodes without children ([#149685](https://github.com/pytorch/pytorch/pull/149685))
- [ca] support anomly mode nan checks with different semantics than eager ([#149897](https://github.com/pytorch/pytorch/pull/149897))
- [Dynamo] Add debug linting option for graph dedupe ([#150053](https://github.com/pytorch/pytorch/pull/150053))
- [Hierarchical Compile] Add cycle detection to graph region expansion ([#150305](https://github.com/pytorch/pytorch/pull/150305))
- [Hierarchical Compile] Apply deduplication after output node creation ([#150306](https://github.com/pytorch/pytorch/pull/150306))
- [dynamo] add reason field to torch.compiler.disable ([#150341](https://github.com/pytorch/pytorch/pull/150341))
- Implement `raise ... from ...` ([#148766](https://github.com/pytorch/pytorch/pull/148766))
- Fix shape guard failure to be valid python ([#149149](https://github.com/pytorch/pytorch/pull/149149))
- use python fallback if there are overflows ([#149197](https://github.com/pytorch/pytorch/pull/149197))
- Support windows in C++ shape guards ([#149211](https://github.com/pytorch/pytorch/pull/149211))
- Generalize compile collective to avoid cuda-bias ([#150405](https://github.com/pytorch/pytorch/pull/150405))
- Allow trace through unittest ([#146500](https://github.com/pytorch/pytorch/pull/146500))
- [export] Symint support (nonstrict, Dim.DYNAMIC) ([#150198](https://github.com/pytorch/pytorch/pull/150198))
- [dynamo] Allow guards to be dropped with custom filter functions. ([#150936](https://github.com/pytorch/pytorch/pull/150936))
- [dynamo][guards] Print relational guards only once ([#150810](https://github.com/pytorch/pytorch/pull/150810))
- Propagate callable parameter types using ParamSpec (#142306) ([#151014](https://github.com/pytorch/pytorch/pull/151014))
- Improve sort with non-constant keys error message ([#151193](https://github.com/pytorch/pytorch/pull/151193))
- [dynamo] handle tensor subclass with non-classmethod `__torch_function__` ([#151061](https://github.com/pytorch/pytorch/pull/151061))
- [reland] Make export._trace._WrapperModule work in strict mode (#146919) ([#151264](https://github.com/pytorch/pytorch/pull/151264))
- [Dynamo] Implement sourceless named tuple support ([#151266](https://github.com/pytorch/pytorch/pull/151266))
- [Dynamo] Clean up old torch function flag ([#149711](https://github.com/pytorch/pytorch/pull/149711))
- [Hierarchical Compile] Fix small bug ([#151293](https://github.com/pytorch/pytorch/pull/151293))
- [Hierarchical Compile] Handle autocast ctx manager ([#151294](https://github.com/pytorch/pytorch/pull/151294))
- [Hierarchical compile] Ensure output nodes are sorted last ([#151295](https://github.com/pytorch/pytorch/pull/151295))
- fix spammy library deinit errors when user passes an invalid TORCH_LOGS argument ([#151678](https://github.com/pytorch/pytorch/pull/151678))
- [dynamic shapes] user-code friendly statically_known_true, has_static_value ([#151601](https://github.com/pytorch/pytorch/pull/151601))
- [Dynamo] Allow inlining into AO quantization modules ([#152934](https://github.com/pytorch/pytorch/pull/152934))
- [1/n][Optimus][Auto-AC] Support activation quantization without scaling ([#148380](https://github.com/pytorch/pytorch/pull/148380))
- [dynamo] Harden torch function dispatchability check for attributes and methods access ([#153082](https://github.com/pytorch/pytorch/pull/153082))
- [export] Dynamo symint support ([#152677](https://github.com/pytorch/pytorch/pull/152677))
- [Set] Add set.symmetric_difference(_update) ([#152901](https://github.com/pytorch/pytorch/pull/152901))
- [Set] Add `set.issubset` and `set.issuperset` ([#152902](https://github.com/pytorch/pytorch/pull/152902))
- [PGO] suggest dynamic whitelist for recompilations ([#154189](https://github.com/pytorch/pytorch/pull/154189))
- Fix: Replacements can cause runtime assertions to disappear and can cause invalid inductor code.   ([#153661](https://github.com/pytorch/pytorch/pull/153661))
- [dynamo] Support namedtuple subclass ([#153982](https://github.com/pytorch/pytorch/pull/153982))
- [pgo] log dynamic whitelist in PT2 Compile Events ([#154747](https://github.com/pytorch/pytorch/pull/154747))
- [FlexAttention] Allow dispatch to SAC for flex ([#150080](https://github.com/pytorch/pytorch/pull/150080))
- Redo D75092426: [internal] Expose additional metadata to compilation callbacks ([#155063](https://github.com/pytorch/pytorch/pull/155063))
- [dynamic shapes] guard individual terms in sym_and; user-code-friendly sym_and/sym_or ([#154737](https://github.com/pytorch/pytorch/pull/154737))
- [Hierarchical-Compile] Hash int args in addition to input shapes ([#155655](https://github.com/pytorch/pytorch/pull/155655))
- [user triton] dynamo support for new host-side TMA API ([#155662](https://github.com/pytorch/pytorch/pull/155662))
- [Hierarchical-Compile] Track mutations for setitem ([#155880](https://github.com/pytorch/pytorch/pull/155880))
- [Dynamo] Add generic and XPU-specific Stream&Event in UserDefineClass ([#155787](https://github.com/pytorch/pytorch/pull/155787))
- [Dynamo] Add XPU API to trace_rules ([#155788](https://github.com/pytorch/pytorch/pull/155788))
- [user triton] triton_kernel_wrap support for new host-side TMA API ([#155777](https://github.com/pytorch/pytorch/pull/155777))
- [PGO] no code state update on dynamic=False ([#155961](https://github.com/pytorch/pytorch/pull/155961))
- [PGO] include ints/floats in suggested whitelist  ([#155980](https://github.com/pytorch/pytorch/pull/155980))
- Support torch.cuda.*Tensor in Dynamo ([#156107](https://github.com/pytorch/pytorch/pull/156107))
- [PGO] fix whitelist scalar bug ([#156194](https://github.com/pytorch/pytorch/pull/156194))
- [dynamo] Add documentation for guard_filter_fn ([#156114](https://github.com/pytorch/pytorch/pull/156114))
- Add runtime profiler info for AOTDispatcher prologue ([#155785](https://github.com/pytorch/pytorch/pull/155785))
- [PGO] frame-specific whitelist logging ([#155959](https://github.com/pytorch/pytorch/pull/155959))
- Revert "[dynamo] Weblink generation when unimplemented_v2() is called (#156033)" ([#156546](https://github.com/pytorch/pytorch/pull/156546))
- [compile][hierarchical compilation] Release nested_compile_region API ([#156449](https://github.com/pytorch/pytorch/pull/156449))
- [ca] Support TorchDispatchMode via pass through ([#156516](https://github.com/pytorch/pytorch/pull/156516))
### not user facing
- [scan] Flattened output of HOP scan ([#148955](https://github.com/pytorch/pytorch/pull/148955))
- [Dynamo] Replace `unimplemented` with`unimplemented_v2` in `torch/_dynamo/variables/base.py` ([#148177](https://github.com/pytorch/pytorch/pull/148177))
- [ca] support for dynamic shapes CopySlices ([#148799](https://github.com/pytorch/pytorch/pull/148799))
- [ca] fix lazily compiled aot bwd ([#149030](https://github.com/pytorch/pytorch/pull/149030))
- [ca] always do initial trace with dynamic shapes ([#148801](https://github.com/pytorch/pytorch/pull/148801))
- [SDPA] Respect `sdpa_kernel`'s `priority_order` setting in `torch.compile`  ([#147768](https://github.com/pytorch/pytorch/pull/147768))
- [ca] clean up aot node deduping ([#149064](https://github.com/pytorch/pytorch/pull/149064))
- [ca] don't inline accumulate grad op ([#149014](https://github.com/pytorch/pytorch/pull/149014))
- Add side_effect to avoid dce custom op in CA graph ([#149181](https://github.com/pytorch/pytorch/pull/149181))
- fix two accuracy regression ([#149172](https://github.com/pytorch/pytorch/pull/149172))
- [dynamo] Add mem leak test ([#149358](https://github.com/pytorch/pytorch/pull/149358))
- [hop] Rework the check of Metadata in the functionalization key ([#148789](https://github.com/pytorch/pytorch/pull/148789))
- [ca] fix dce for side-effects ([#149336](https://github.com/pytorch/pytorch/pull/149336))
- [logging] Add python version to dynamo_compile table ([#149419](https://github.com/pytorch/pytorch/pull/149419))
- Fix a typo "trochrec" to "torchrec" ([#149542](https://github.com/pytorch/pytorch/pull/149542))
- Allow setting attribute to NestedUserFunctionVariable ([#146505](https://github.com/pytorch/pytorch/pull/146505))
- Set __context__/__cause__ when generator raise `StopIteration` ([#148765](https://github.com/pytorch/pytorch/pull/148765))
- Add `is_batchedtensor` to dynamo builder ([#149541](https://github.com/pytorch/pytorch/pull/149541))
- Catch OSError in general when writing files ([#149464](https://github.com/pytorch/pytorch/pull/149464))
- [dynamo] Ensure placeholder name is not an intermediate node name ([#149712](https://github.com/pytorch/pytorch/pull/149712))
- fix dynamic float when dynamic=True ([#149564](https://github.com/pytorch/pytorch/pull/149564))
- [dynamo][hooks] config to wrap the top frame in a wrapper ([#149758](https://github.com/pytorch/pytorch/pull/149758))
- Super tiny fix typo ([#149109](https://github.com/pytorch/pytorch/pull/149109))
- [dynamo] keep chained exceptions in user-facing tracebacks ([#149676](https://github.com/pytorch/pytorch/pull/149676))
- [ca] API comments and support dynamic shapes via configs ([#149709](https://github.com/pytorch/pytorch/pull/149709))
- [DYNAMO] [BUG FIX] correct casting to boolean for TORCH_COMPILE_DISABLE ([#149852](https://github.com/pytorch/pytorch/pull/149852))
- [dynamo] fix calling torch function on newly constructed tensor subclass ([#149481](https://github.com/pytorch/pytorch/pull/149481))
- [invoke_subgraph] Support pending unbacked symint ([#149297](https://github.com/pytorch/pytorch/pull/149297))
- [dynamo] Fix handling of setattr with some tensor attributes ([#149791](https://github.com/pytorch/pytorch/pull/149791))
- [Bugfix] Add handling for buffer overrides ([#149882](https://github.com/pytorch/pytorch/pull/149882))
- Fix non-strict export doesn't turn on dynamo for hop ([#149903](https://github.com/pytorch/pytorch/pull/149903))
- [ca] introduce RuntimeState to support c++ hooks via graph breaks ([#149987](https://github.com/pytorch/pytorch/pull/149987))
- [dynamo][invoke_subgraph] Input aliasing and mutation check in Dynamo ([#148953](https://github.com/pytorch/pytorch/pull/148953))
- [Dynamo] Fix `is_compile_supported()` when `device_type` contains device index ([#147837](https://github.com/pytorch/pytorch/pull/147837))
- Fix _Waitcounter decorator and dd backward pass wait counter ([#150235](https://github.com/pytorch/pytorch/pull/150235))
- [invoke_subgraph] Support unbacked ([#149298](https://github.com/pytorch/pytorch/pull/149298))
- [dynamo] add error message for unsupported LOAD_BUILD_CLASS ([#150323](https://github.com/pytorch/pytorch/pull/150323))
- Unify on dynamo_compile as the overall wait counter ([#150293](https://github.com/pytorch/pytorch/pull/150293))
- [MPSInductor] torch.complex128 is unsupported on MPS ([#150386](https://github.com/pytorch/pytorch/pull/150386))
- [dynamo][hooks] use wrap_top_frame config for functions ([#150209](https://github.com/pytorch/pytorch/pull/150209))
- [Hierarchical Compile] Remove spammy debug log ([#150303](https://github.com/pytorch/pytorch/pull/150303))
- [Hierarchical Compile] Add cycle detection function for debug ([#150304](https://github.com/pytorch/pytorch/pull/150304))
- [dynamo] add dynamo disable reasons to codebase ([#150440](https://github.com/pytorch/pytorch/pull/150440))
- [dynamo] emit only 1 graph break message on unrecoverable data-dependent assert fail ([#150471](https://github.com/pytorch/pytorch/pull/150471))
- Refactoring: fix the python constant check ([#150608](https://github.com/pytorch/pytorch/pull/150608))
- [dynamo] disable new test_assert_failure_in_generic_ctx_mgr internally ([#150631](https://github.com/pytorch/pytorch/pull/150631))
- support guard or false/true in user code and add tests ([#150178](https://github.com/pytorch/pytorch/pull/150178))
- Make CompileEventLogger more defensive w.r.t to AOTAutogradCache and FXGraphCache ([#150423](https://github.com/pytorch/pytorch/pull/150423))
- [Bugfix] Fix compile error with `torch.Tensor.unsqueeze_` and inplace views called from Tensor Class ([#150573](https://github.com/pytorch/pytorch/pull/150573))
- [Dynamo] Fix `dict.items()` return type ([#150112](https://github.com/pytorch/pytorch/pull/150112))
- [Dynamo][Misc] Apply typing hints for `codegen` ([#150289](https://github.com/pytorch/pytorch/pull/150289))
- [logging] Add pgo remote get/put timings to dynamo_compile ([#150322](https://github.com/pytorch/pytorch/pull/150322))
- Refactor: add initialization of math.lcm into torch_c_binding_in_graph_functions ([#150766](https://github.com/pytorch/pytorch/pull/150766))
- Facilitate at::_weight_int4pack_mm_with_scale_and_zeros related registration ([#147962](https://github.com/pytorch/pytorch/pull/147962))
- [dynamo] reconstruct functions decorated in the compiled region properly ([#150645](https://github.com/pytorch/pytorch/pull/150645))
- Code Clean: Remove specific bytecode support in dynamo for python3.8 ([#150838](https://github.com/pytorch/pytorch/pull/150838))
- Avoid circular imports in tracing_state_functions ([#150325](https://github.com/pytorch/pytorch/pull/150325))
- [dynamo] unpack sequence lazily for list extend/deque extendleft ([#150965](https://github.com/pytorch/pytorch/pull/150965))
- [Dynamo] Allow dynamo to handle 'or' operator between two dicts ([#147305](https://github.com/pytorch/pytorch/pull/147305))
- [dynamo] unimplemented -> unimplemented_v2 in variables/builder.py ([#151044](https://github.com/pytorch/pytorch/pull/151044))
- cleanup JK for duplicate pt2 compile callbacks prevention ([#148704](https://github.com/pytorch/pytorch/pull/148704))
- [dynamo] Deprecate enable_cpp_framelocals_guard_eval config variable - default: True ([#151008](https://github.com/pytorch/pytorch/pull/151008))
- [dynamo] Use sentinel value for guard filter. ([#151131](https://github.com/pytorch/pytorch/pull/151131))
- [dynamo][nn_module] Use method.__self__ to find source for patched methods ([#151164](https://github.com/pytorch/pytorch/pull/151164))
- [ez][dynamo] some code movement ([#150753](https://github.com/pytorch/pytorch/pull/150753))
- [ez]][dynamo] remove useless super().__init__() ([#150754](https://github.com/pytorch/pytorch/pull/150754))
- [ez] dynamo fix typo in comment ([#150828](https://github.com/pytorch/pytorch/pull/150828))
- [ez] remove unused arg in _create_wrapped_callback ([#151179](https://github.com/pytorch/pytorch/pull/151179))
- [dynamo] Graph break fixes while tracing inspect module ([#151168](https://github.com/pytorch/pytorch/pull/151168))
- [dynamo][error message] Hint for dict_items as inputs to the compiled region ([#151169](https://github.com/pytorch/pytorch/pull/151169))
- Using hasattr for `_boxed_call` is asking for trouble ([#151130](https://github.com/pytorch/pytorch/pull/151130))
- [dynamo][invoke_subgraph] Use FxGraphModule comparison instead of hashing ([#150911](https://github.com/pytorch/pytorch/pull/150911))
- [dynamo] Properly handle `super().some_classmethod(...)` ([#151060](https://github.com/pytorch/pytorch/pull/151060))
- [dynamo] Remove `traceable_tensor_subclasses`-related code ([#151062](https://github.com/pytorch/pytorch/pull/151062))
- [Dynamo] Fix the unimplemented_v2 of EventVariable.call_method in ctx_manager.py ([#151208](https://github.com/pytorch/pytorch/pull/151208))
- Gracefully handle optree less than minimum version, part 2 ([#151257](https://github.com/pytorch/pytorch/pull/151257))
- Replace all random is_fbcode imports to environment ([#151283](https://github.com/pytorch/pytorch/pull/151283))
- Record how many parameters we're parsing within dynamo ([#148508](https://github.com/pytorch/pytorch/pull/148508))
- Fix Issues in deferring runtime assertions. ([#151170](https://github.com/pytorch/pytorch/pull/151170))
- fix ambiguous error message ([#150086](https://github.com/pytorch/pytorch/pull/150086))
- [dynamo] unimplemented -> unimplemented_v2 in variables/builtin.py ([#151145](https://github.com/pytorch/pytorch/pull/151145))
- [MegaCache] Rename the PGO artifact when used between different jobs ([#151482](https://github.com/pytorch/pytorch/pull/151482))
- [dynamo] support fb internal bytecode EAGER_IMPORT_NAME ([#151362](https://github.com/pytorch/pytorch/pull/151362))
- [logging] Fix duration logging for dynamo_compile ([#151749](https://github.com/pytorch/pytorch/pull/151749))
- [logging] Put "everything" WaitCounters in dynamo_timed ([#151757](https://github.com/pytorch/pytorch/pull/151757))
- [Dynamo][Easy] Remove unreachable code ([#151739](https://github.com/pytorch/pytorch/pull/151739))
- [dynamo][ci] Fix recently broken test ([#151877](https://github.com/pytorch/pytorch/pull/151877))
- Fix circular imports ([#151939](https://github.com/pytorch/pytorch/pull/151939))
- Support regexes in dynamic sources allowlist ([#151766](https://github.com/pytorch/pytorch/pull/151766))
- [Dynamo] Use LazyVariableTracker in base VT ([#151847](https://github.com/pytorch/pytorch/pull/151847))
- add basic unit tests and noop config ([#152036](https://github.com/pytorch/pytorch/pull/152036))
- Add functionality for installing free variables ([#151134](https://github.com/pytorch/pytorch/pull/151134))
- [dynamo] Guard serialization for NOT_PRESENT_IN_GENERIC_DICT ([#151343](https://github.com/pytorch/pytorch/pull/151343))
- [dynamo] Guard serialization for HASATTR ([#151349](https://github.com/pytorch/pytorch/pull/151349))
- [PT2] - Allowlist should have precedence ([#151942](https://github.com/pytorch/pytorch/pull/151942))
- [dynamo] remove dead code for DATA_PTR_MATCH ([#152206](https://github.com/pytorch/pytorch/pull/152206))
- Add an additional check to trigger graph break for sparse tensor ([#151897](https://github.com/pytorch/pytorch/pull/151897))
- [Dynamo] Replace `unimplemented` with `unimplemented_v2` in `torch/_dynamo/variables/nn_module.py` ([#151895](https://github.com/pytorch/pytorch/pull/151895))
- [Dynamo] Replace `unimplemented` with `unimplemented_v2` in `torch/_dynamo/variables/lists.py` ([#151873](https://github.com/pytorch/pytorch/pull/151873))
- [Dynamo] Replace `unimplemented` with `unimplemented_v2` in `torch/_dynamo/variables/iter.py` ([#151789](https://github.com/pytorch/pytorch/pull/151789))
- [Dynamo][Typing] Enable typing hints for `tx` in `misc.py` ([#152412](https://github.com/pytorch/pytorch/pull/152412))
- [dynamo] Guard serialization for TYPE_MATCH ([#152325](https://github.com/pytorch/pytorch/pull/152325))
- [dynamo] Guard serialization for DICT_VERSION ([#152326](https://github.com/pytorch/pytorch/pull/152326))
- [dynamo] Guard serialization for DICT_CONTAINS ([#152327](https://github.com/pytorch/pytorch/pull/152327))
- [dynamo] Guard serialization for BOOL_MATCH. ([#152328](https://github.com/pytorch/pytorch/pull/152328))
- [dynamo] Guard serialization for NONE_MATCH. ([#152329](https://github.com/pytorch/pytorch/pull/152329))
- [dynamo] Guard serialization for ID_MATCH ([#152330](https://github.com/pytorch/pytorch/pull/152330))
- [dynamo] Guard serialization for DISPATCH_KEY_SET_MATCH ([#152331](https://github.com/pytorch/pytorch/pull/152331))
- [dynamo] Guard serialization for NAME_MATCH ([#152332](https://github.com/pytorch/pytorch/pull/152332))
- [dynamo] Relax guard introduced when tracing `__call__` on user defined object ([#152395](https://github.com/pytorch/pytorch/pull/152395))
- [HOP][be] make supports_input_mutation and aliasisng a class field ([#152244](https://github.com/pytorch/pytorch/pull/152244))
- [invoke_subgraph] Unpacked operands ([#152547](https://github.com/pytorch/pytorch/pull/152547))
- [invoke_subgraph] rename identifiers to prevent python mangling ([#152581](https://github.com/pytorch/pytorch/pull/152581))
- Make PGO code state not sensitive to file path by hashing file content when the file is available.  ([#152628](https://github.com/pytorch/pytorch/pull/152628))
- [associative_scan] Refactoring of input checking and dynamo invocation ([#148657](https://github.com/pytorch/pytorch/pull/148657))
- Fix two error messages involving Tensor.dense() ([#152631](https://github.com/pytorch/pytorch/pull/152631))
- Add methods for checking Triton availability to the device interface ([#152529](https://github.com/pytorch/pytorch/pull/152529))
- [dynamo] Guard serialization for DUAL LEVEL. ([#152615](https://github.com/pytorch/pytorch/pull/152615))
- [dynamo] Guard serialization for FUNCTORCH_STACK_MATCH ([#152616](https://github.com/pytorch/pytorch/pull/152616))
- [dynamo] Guard serialization for DUPLICATE_INPUT. ([#152687](https://github.com/pytorch/pytorch/pull/152687))
- [dynamo] Guard serialization for WEAKREF_ALIVE ([#152716](https://github.com/pytorch/pytorch/pull/152716))
- [dynamo] Guard serialization for MAPPING_KEYS_CHECK ([#152721](https://github.com/pytorch/pytorch/pull/152721))
- [dynamo] Guard serialization for DICT_KEYS_MATCH ([#152723](https://github.com/pytorch/pytorch/pull/152723))
- [dynamo] replace `unimplemented` with `unimplemented_v2` in `variables/torch_functions.py` ([#151278](https://github.com/pytorch/pytorch/pull/151278))
- [ez] fix a bunch of typos in dynamo ([#152886](https://github.com/pytorch/pytorch/pull/152886))
- [Dynamo] Guard serialization for TENSOR_SUBCLASS_METADATA_MATCH ([#152626](https://github.com/pytorch/pytorch/pull/152626))
- [Dynamo] Guard serialization for EQUALS_MATCH ([#152704](https://github.com/pytorch/pytorch/pull/152704))
- [Dynamo] Guard serialization for CONSTANT_MATCH ([#152724](https://github.com/pytorch/pytorch/pull/152724))
- [dynamo][ez] Remove unused guard OBJECT_MUTATION. ([#152855](https://github.com/pytorch/pytorch/pull/152855))
- [Dynamo] Replace `unimplemented` with `unimplemented_v2` in `torch/_dynamo/variables/misc.py` [1/2] ([#152274](https://github.com/pytorch/pytorch/pull/152274))
- Use `torch.types.Device` in `device_interface.py` ([#152935](https://github.com/pytorch/pytorch/pull/152935))
- [Dynamo] Guard serialization for NN_MODULE ([#152725](https://github.com/pytorch/pytorch/pull/152725))
- [Dynamo] Guard serialization for FUNCTION_MATCH ([#152727](https://github.com/pytorch/pytorch/pull/152727))
- [Dynamo] Guard serialization for CLOSURE_MATCH ([#152728](https://github.com/pytorch/pytorch/pull/152728))
- [Dynamo] Guard serialization for SEQUENCE_LENGTH ([#152730](https://github.com/pytorch/pytorch/pull/152730))
- [Dynamo] Guard serialization for TUPLE_ITERATOR_LEN ([#152865](https://github.com/pytorch/pytorch/pull/152865))
- [Dynamo] Guard serialization for RANGE_ITERATOR_MATCH ([#152872](https://github.com/pytorch/pytorch/pull/152872))
- [Dynamo] Remove unused guard PYMODULE_MATCH ([#152961](https://github.com/pytorch/pytorch/pull/152961))
- [dynamo] Fix bug in hasattr(tensor, "size") ([#152883](https://github.com/pytorch/pytorch/pull/152883))
- [dynamo] Fix super and classmethod binding of cls object ([#153105](https://github.com/pytorch/pytorch/pull/153105))
- Stop proxy-ing autograd.Function.ctx into the graph ([#152621](https://github.com/pytorch/pytorch/pull/152621))
- [dynamo][pr_time_benchmark] Add dynamo benchmark to stress test inlining ([#153159](https://github.com/pytorch/pytorch/pull/153159))
- [map] always turn on dynamo for map ([#152041](https://github.com/pytorch/pytorch/pull/152041))
- [dynamo] Guard serialization for EMPTY_NN_MODULE_HOOKS_DICT ([#153255](https://github.com/pytorch/pytorch/pull/153255))
- [dynamo] Guard serialization for global state guards (GRAD_MODE, DETERMINISTIC_ALGORITHMS, TORCH_FUNCTION_STATE, FSDP_TRAINING_STATE) ([#153256](https://github.com/pytorch/pytorch/pull/153256))
- [dynamo] Guard serialization for DEFAULT_DEVICE ([#153257](https://github.com/pytorch/pytorch/pull/153257))
- [dynamo] Guard serialization for SHAPE_ENV ([#153258](https://github.com/pytorch/pytorch/pull/153258))
- Fix path matching in `CPythonTestCase/setUpClass` ([#153070](https://github.com/pytorch/pytorch/pull/153070))
- Remove `property` from python_type function ([#152900](https://github.com/pytorch/pytorch/pull/152900))
- [ca][api] config api shouldn't error with optimize_assert ([#153193](https://github.com/pytorch/pytorch/pull/153193))
- [ca] support higher order gradients (create_graph=True) ([#153222](https://github.com/pytorch/pytorch/pull/153222))
- Fix test broken by D73809989 ([#153413](https://github.com/pytorch/pytorch/pull/153413))
- [dynamo] Add test to ensure we don't print fx graph upon data dependent graph break ([#153416](https://github.com/pytorch/pytorch/pull/153416))
- [dynamo] fix potential circular import error in decorators.py ([#153217](https://github.com/pytorch/pytorch/pull/153217))
- [dynamo][copmile-time] Handle builtins first in LOAD_GLOBAL ([#153458](https://github.com/pytorch/pytorch/pull/153458))
- [dynamo][compile-time] Cache whether a function is inlineable ([#153192](https://github.com/pytorch/pytorch/pull/153192))
- [dynamo][compile-time] Cache the cleaned insturctions while inlining ([#153333](https://github.com/pytorch/pytorch/pull/153333))
- [dynamo][compile-time] Cache the function signature to speedup inlining ([#153396](https://github.com/pytorch/pytorch/pull/153396))
- [dynamo][compile-time] Compute logging related flags once ([#153426](https://github.com/pytorch/pytorch/pull/153426))
- [dynamo][compile-time] Faster inspect getattr_static for torch.Tensor ([#153522](https://github.com/pytorch/pytorch/pull/153522))
- [dynamo][compile-time] Cache method on load builtin ([#153524](https://github.com/pytorch/pytorch/pull/153524))
- [dynamo][torch-function] Prevent unnecessary __torch_function__ tracing ([#153551](https://github.com/pytorch/pytorch/pull/153551))
- [Dynamo] Catch unserialisable NN modules ([#153503](https://github.com/pytorch/pytorch/pull/153503))
- [Set] Handle exception in ConstantVariable operation ([#152987](https://github.com/pytorch/pytorch/pull/152987))
- [Set] Raise `TypeError` if argument is unhashable ([#152988](https://github.com/pytorch/pytorch/pull/152988))
- [Set] Raise TypeError if number of arguments mismatch ([#152904](https://github.com/pytorch/pytorch/pull/152904))
- [Set] Raise `KeyError` if elem not contained in the set ([#152903](https://github.com/pytorch/pytorch/pull/152903))
- [Set] Add `set.difference(_update)` ([#152905](https://github.com/pytorch/pytorch/pull/152905))
- [Set] Add `set.intersection(_update)` ([#152906](https://github.com/pytorch/pytorch/pull/152906))
- [Set] Update `set.union` and `set.update` to support *args ([#152989](https://github.com/pytorch/pytorch/pull/152989))
- [Set] Raise KeyError on empty `set.pop()` ([#152907](https://github.com/pytorch/pytorch/pull/152907))
- [Set] Add correct set/frozenset __init__ behavior ([#152908](https://github.com/pytorch/pytorch/pull/152908))
- [Set] Raise TypeError if set is called with the wrong number of arguments ([#152990](https://github.com/pytorch/pytorch/pull/152990))
- dynamo: Log if we're using dynamic shapes via set_feature_usage ([#153490](https://github.com/pytorch/pytorch/pull/153490))
- [HOP] Mutation and alias rework ([#146658](https://github.com/pytorch/pytorch/pull/146658))
- [MegaCache] Make MegaCache generic to allow external plugins registration ([#152977](https://github.com/pytorch/pytorch/pull/152977))
- [dynamo] Properly handle `torch.script.jit` under `@staticmethod` ([#153984](https://github.com/pytorch/pytorch/pull/153984))
- [dynamo] renamed _fn for more clarity and put a comment of user compiler user ([#154026](https://github.com/pytorch/pytorch/pull/154026))
- Add a HOP to bypass tracing of a wrapper function while tracing the wrapped function ([#153487](https://github.com/pytorch/pytorch/pull/153487))
- [dynamo] unimplemented -> unimplemented_v2 in variables/dict.py ([#154040](https://github.com/pytorch/pytorch/pull/154040))
- catch CSE recursion depth errors ([#154039](https://github.com/pytorch/pytorch/pull/154039))
- [dynamo] raise observed exception for module attribute errors ([#153659](https://github.com/pytorch/pytorch/pull/153659))
- [AOTAutogradCache] Fix CHROMIUM_EVENT_LOG being none ([#154258](https://github.com/pytorch/pytorch/pull/154258))
- [dynamo] Use UUID for compiled function variable names. ([#154148](https://github.com/pytorch/pytorch/pull/154148))
- add sticky cache pgo ([#154418](https://github.com/pytorch/pytorch/pull/154418))
- [dynamo] Support using symint from dispatcher-style tensor subclass ([#154130](https://github.com/pytorch/pytorch/pull/154130))
- [dynamo] dynamic gb_type -> static gb_type ([#154435](https://github.com/pytorch/pytorch/pull/154435))
- [precompile] Prune local scope variables for guard serialization. ([#154431](https://github.com/pytorch/pytorch/pull/154431))
- [dynamo] updating gb_type names for uniqueness ([#154452](https://github.com/pytorch/pytorch/pull/154452))
- [precompile] Add Exception type PackageError for unsupported precompile features. ([#154430](https://github.com/pytorch/pytorch/pull/154430))
- [CAG] Support for call_module at copy paste aot bwd graph ([#153827](https://github.com/pytorch/pytorch/pull/153827))
- Support unbacked whitelist ([#154295](https://github.com/pytorch/pytorch/pull/154295))
- [dynamo] keep C++ symbolic shape guards disabled for benchmarks ([#151225](https://github.com/pytorch/pytorch/pull/151225))
- [multigraph] add specialize_on kwarg to mark_{dynamic,unbacked} ([#153433](https://github.com/pytorch/pytorch/pull/153433))
- [dynamo] Trace into descriptor with `__set__` ([#154176](https://github.com/pytorch/pytorch/pull/154176))
- [multigraph] fix composabilty with aotautograd cache ([#153526](https://github.com/pytorch/pytorch/pull/153526))
- [dynamo] fix: added star operator for graph_break_hints ([#154713](https://github.com/pytorch/pytorch/pull/154713))
- [BE][Ez]: Improve dynamo utils typing with TypeIs and TypeGuard ([#154639](https://github.com/pytorch/pytorch/pull/154639))
- [BE][Ez]: Fix typo in dynamo utils #154639 ([#154748](https://github.com/pytorch/pytorch/pull/154748))
- [dynamo] Fix syntax error in aot graph from kwarg-less `torch.Tensor.[random_|uniform_]` calls ([#154645](https://github.com/pytorch/pytorch/pull/154645))
- [dynamo] Remove dead code path for `torch.Tensor.view(*shape)` ([#154646](https://github.com/pytorch/pytorch/pull/154646))
- [dynamo][guards] Prevent LENGTH guard on nn modules ([#154763](https://github.com/pytorch/pytorch/pull/154763))
- [dynamo] Upcast torch.Size + tuple to be of size torch.Size ([#154830](https://github.com/pytorch/pytorch/pull/154830))
- [dynamo] Remove all `skipIfTorchDynamo` in `test_tensor_creation_ops.py` ([#154693](https://github.com/pytorch/pytorch/pull/154693))
- [dynamo] fix pruning locals with ShapeEnvSource ([#154752](https://github.com/pytorch/pytorch/pull/154752))
- Combine sticky pgo key with job id ([#154863](https://github.com/pytorch/pytorch/pull/154863))
- [dynamo] Reconstruct defaultdict properly ([#154931](https://github.com/pytorch/pytorch/pull/154931))
- [torch.compile] handle a custom __delattr__ method correctly ([#150899](https://github.com/pytorch/pytorch/pull/150899))
- [dynamo] [1/3] updated gbid mapping for initial registry creation ([#154738](https://github.com/pytorch/pytorch/pull/154738))
- [dynamo] [2/3] added add_new_gb_type functionality ([#154886](https://github.com/pytorch/pytorch/pull/154886))
- [dynamo] [3/3] added cmd_update_gb_type which supports updating an existing gb_type properties and optional arg to change gb_type name ([#154985](https://github.com/pytorch/pytorch/pull/154985))
- [HOP] Rework Autograd DispatchKey for scan and map ([#153336](https://github.com/pytorch/pytorch/pull/153336))
- [dynamo] sample gb_registry json file for website testing purposes ([#155160](https://github.com/pytorch/pytorch/pull/155160))
- [reland][dynamo] Mark a vt unspecialized nn module variable source earlier ([#155099](https://github.com/pytorch/pytorch/pull/155099))
- [dynamo][cleanup] Simplify disabling of the helper functions on tensor properties ([#155259](https://github.com/pytorch/pytorch/pull/155259))
- [BE][Ez]: Improve typing in torch._logging ([#155345](https://github.com/pytorch/pytorch/pull/155345))
- [dynamo] constant fold torch.cuda.is_initialized ([#155300](https://github.com/pytorch/pytorch/pull/155300))
- [invoke_subgraph] Throw assertion on uncaptured speculate_subgraph ([#155270](https://github.com/pytorch/pytorch/pull/155270))
- [invoke_subgraph] Add logging ([#155284](https://github.com/pytorch/pytorch/pull/155284))
- Add docblock to torch/_dynamo/trace_rules.py ([#155401](https://github.com/pytorch/pytorch/pull/155401))
- Add docblock to torch/_dynamo/side_effects.py ([#155403](https://github.com/pytorch/pytorch/pull/155403))
- Add docblock to torch/_dynamo/variables/builtin.py ([#155402](https://github.com/pytorch/pytorch/pull/155402))
- Fix dynamo tracing into AOTAutogradCache results in cpu tensors ([#155251](https://github.com/pytorch/pytorch/pull/155251))
- [Dynamo] Replace `unimplemented` with `unimplemented_v2` in `torch/_dynamo/variables/tensor.py` ([#153146](https://github.com/pytorch/pytorch/pull/153146))
- [test] use JK to force graph break on slow aliasing/mutation/dynamic_shape behavior ([#155257](https://github.com/pytorch/pytorch/pull/155257))
- [precompile] Ensure @disable()-ed function won't trigger recompile from precompile bytecode. ([#155363](https://github.com/pytorch/pytorch/pull/155363))
- [dynamo] added additional_info functionality ([#155526](https://github.com/pytorch/pytorch/pull/155526))
- [dynamo] Avoid unncessary caching source codegen ([#155376](https://github.com/pytorch/pytorch/pull/155376))
- [ca] make torch.compile API respect ambient disable contexts ([#155473](https://github.com/pytorch/pytorch/pull/155473))
- [dynamo][ci] update PYTORCH_TEST_WITH_DYNAMO xfail/skips script for 3.13 ([#155570](https://github.com/pytorch/pytorch/pull/155570))
- [ca] better error message for subclasses not supported by FakeTensor ([#155481](https://github.com/pytorch/pytorch/pull/155481))
- [dynamo] uploaded full json file of all unimplemented_v2() calls currently in repository ([#155758](https://github.com/pytorch/pytorch/pull/155758))
- [dynamo] Use BINARY_SUBSCR for pre-graph bytecode for regular dict accesses ([#155727](https://github.com/pytorch/pytorch/pull/155727))
- Support tuning of _grouped_mm ([#153953](https://github.com/pytorch/pytorch/pull/153953))
- [dynamo] add missing algorithm header ([#154754](https://github.com/pytorch/pytorch/pull/154754))
- [precompile] Add CompilePackage to serialize dynamo states. ([#155118](https://github.com/pytorch/pytorch/pull/155118))
- [precompile] Implement PrecompileContext for recording precompile artifacts, integrate with CompilePackage ([#154415](https://github.com/pytorch/pytorch/pull/154415))
- [Dynamo] Add torch.accelerator API to trace_rules ([#155884](https://github.com/pytorch/pytorch/pull/155884))
- [dynamo] Provide helper functions for guard filter hook ([#155083](https://github.com/pytorch/pytorch/pull/155083))
- [dynamo] support tracing weakref callback ([#155761](https://github.com/pytorch/pytorch/pull/155761))
- [dynamo] fix KeyError in LOAD_FAST_CHECK ([#155763](https://github.com/pytorch/pytorch/pull/155763))
- [dynamo] Support tracing of functools.lru_cached method ([#156125](https://github.com/pytorch/pytorch/pull/156125))
- [ca] Allow using compiled autograd context managers during backward runtime ([#156120](https://github.com/pytorch/pytorch/pull/156120))
- flex attention: fix dispatch order for tensor subclasses, avoid hardcoding call to faketensor impl in dynamo ([#151719](https://github.com/pytorch/pytorch/pull/151719))
- Fix fx tracing for mark dynamic ([#156346](https://github.com/pytorch/pytorch/pull/156346))
- Port two dynamo test cases for Intel GPU ([#156056](https://github.com/pytorch/pytorch/pull/156056))
- [dynamo] Fix cycle reference problem caused by recursive collect_temp_source in codegen ([#155791](https://github.com/pytorch/pytorch/pull/155791))
- [dynamo][guards] Catch exception and return false in the backend match ([#156341](https://github.com/pytorch/pytorch/pull/156341))
- dynamo: Don't crash when someone tries to access a non existent list member ([#156335](https://github.com/pytorch/pytorch/pull/156335))
- Add internal use only utility to allow externally visible side effects within HOPs ([#155715](https://github.com/pytorch/pytorch/pull/155715))
- [dynamo] Weblink generation when unimplemented_v2() is called ([#156033](https://github.com/pytorch/pytorch/pull/156033))
- [ca] suggest to disable compiled autograd for trace-time NotImplementedErrors ([#156509](https://github.com/pytorch/pytorch/pull/156509))
- Don't change set_skip_guard_eval_unsafe for DisableContext, since compiler won't run ([#156490](https://github.com/pytorch/pytorch/pull/156490))
- [dynamo] Weblink generation when unimplemented_v2() is called ([#156033](https://github.com/pytorch/pytorch/pull/156033))
- [dynamo] Support builtin bool on non-constant VTs ([#155863](https://github.com/pytorch/pytorch/pull/155863))
- Revert "[dynamo] handle fullgraph toggle using nested torch.compile (#155166)" ([#156624](https://github.com/pytorch/pytorch/pull/156624))
- [dynamo] fix selecting shape guards ([#154772](https://github.com/pytorch/pytorch/pull/154772))
- [dynamo] fix debugging code_parts for relational guards ([#154753](https://github.com/pytorch/pytorch/pull/154753))
- [dynamo] update to lru_cache message and updated user stack trace in debug mode ([#156639](https://github.com/pytorch/pytorch/pull/156639))
- [ca] default on in CI, with fallback for tests in test/compiled_autograd_skips/ ([#155480](https://github.com/pytorch/pytorch/pull/155480))
- partitioner: ensure collectives saved by SAC that are actually unused in the bw are properly not saved ([#149652](https://github.com/pytorch/pytorch/pull/149652))
- partitioner/SAC: fix recompute tag propagation for ops with list[tensor] inputs ([#152195](https://github.com/pytorch/pytorch/pull/152195))
- add min/max_seqlen to non_differentiable ([#151750](https://github.com/pytorch/pytorch/pull/151750))
- bf16 grouped gemm ([#150374](https://github.com/pytorch/pytorch/pull/150374))
- [dynamic shapes] support SymInt inputs for kthvalue ([#152151](https://github.com/pytorch/pytorch/pull/152151))
- support multinomial for dynamic num_samples ([#149463](https://github.com/pytorch/pytorch/pull/149463))
- [partitioner] always ban compiler-driven recompute of collectives by default ([#147561](https://github.com/pytorch/pytorch/pull/147561))
- Support subclass constructor capturing in export ([#147014](https://github.com/pytorch/pytorch/pull/147014))
- [AOTI][reland] Update test runner to use the new APIs ([#149412](https://github.com/pytorch/pytorch/pull/149412))
- [export] specialize for aten.to ([#149235](https://github.com/pytorch/pytorch/pull/149235))
- [1/N] Use internal linkage in torch/csrc C++ files. ([#150930](https://github.com/pytorch/pytorch/pull/150930))
- Reland fast gather and index implementation ([#151917](https://github.com/pytorch/pytorch/pull/151917))
- Support XPU in memory tracker ([#150703](https://github.com/pytorch/pytorch/pull/150703))
- Fix xrefs ([#151888](https://github.com/pytorch/pytorch/pull/151888))
- Add option to use mempool on OOM ([#151487](https://github.com/pytorch/pytorch/pull/151487))
- [ca] Functionalize AccumulateGrad ([#155521](https://github.com/pytorch/pytorch/pull/155521))
- [pt2d] Add reorder_comms_preserving_peak_memory pass ([#146562](https://github.com/pytorch/pytorch/pull/146562))
- fix numpy compatibility for 2d small list indices ([#154806](https://github.com/pytorch/pytorch/pull/154806))
- Resubmit Remove MemPoolContext  (#154042) ([#154746](https://github.com/pytorch/pytorch/pull/154746))
### security
